<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Process-Based Modeling - Probabilistic and Process Simulation | Quantitative Environmental Methods: LRES 546</title>
  <meta name="description" content="Chapter 4 Process-Based Modeling - Probabilistic and Process Simulation | Quantitative Environmental Methods: LRES 546" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Process-Based Modeling - Probabilistic and Process Simulation | Quantitative Environmental Methods: LRES 546" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Process-Based Modeling - Probabilistic and Process Simulation | Quantitative Environmental Methods: LRES 546" />
  
  
  

<meta name="author" content="Tim Covino &amp; Lauren Kremer" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"/>
<link rel="next" href="model-classification-and-application.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">lres_546</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Part 1: Foundations of Environmental Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-overview-and-objectives"><i class="fa fa-check"></i><b>1.2</b> Course overview and objectives</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i><b>1.3</b> Course Description</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.4</b> Structure</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#philosophical-approach-and-resources"><i class="fa fa-check"></i><b>1.5</b> Philosophical approach and resources</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#tentative-schedule-subject-to-change"><i class="fa fa-check"></i><b>1.6</b> Tentative schedule, subject to change</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-tutorial.html"><a href="r-tutorial.html"><i class="fa fa-check"></i><b>2</b> R Tutorial</a></li>
<li class="chapter" data-level="3" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><i class="fa fa-check"></i><b>3</b> Fundamentals of Hydrological Analysis - Physical Hydrology and Empirical Methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#hydrograph-separation"><i class="fa fa-check"></i><b>3.1</b> Hydrograph separation</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#learning-module-1"><i class="fa fa-check"></i><b>3.1.1</b> Learning Module 1</a></li>
<li class="chapter" data-level="3.1.2" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#labwork-20-pts"><i class="fa fa-check"></i><b>3.1.2</b> Labwork (20 pts)</a></li>
<li class="chapter" data-level="3.1.3" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#repo-link"><i class="fa fa-check"></i><b>3.1.3</b> Repo link</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#return-intervals"><i class="fa fa-check"></i><b>3.2</b> Return Intervals</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#learning-module-2"><i class="fa fa-check"></i><b>3.2.1</b> Learning Module 2</a></li>
<li class="chapter" data-level="3.2.2" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#repo-link-1"><i class="fa fa-check"></i><b>3.2.2</b> Repo link</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#rational-method-and-nrcs-curve-number-20-pts"><i class="fa fa-check"></i><b>3.3</b> Rational method and NRCS curve number (20 pts)</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#learning-module-3"><i class="fa fa-check"></i><b>3.3.1</b> Learning Module 3</a></li>
<li class="chapter" data-level="3.3.2" data-path="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html"><a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html#repo-link-2"><i class="fa fa-check"></i><b>3.3.2</b> Repo link</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="process-based-modeling---probabilistic-and-process-simulation.html"><a href="process-based-modeling---probabilistic-and-process-simulation.html"><i class="fa fa-check"></i><b>4</b> Process-Based Modeling - Probabilistic and Process Simulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="process-based-modeling---probabilistic-and-process-simulation.html"><a href="process-based-modeling---probabilistic-and-process-simulation.html#transfer-function-rainfall-runoff-models"><i class="fa fa-check"></i><b>4.1</b> Transfer function rainfall-runoff models</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="process-based-modeling---probabilistic-and-process-simulation.html"><a href="process-based-modeling---probabilistic-and-process-simulation.html#learning-module-4"><i class="fa fa-check"></i><b>4.1.1</b> Learning Module 4</a></li>
<li class="chapter" data-level="4.1.2" data-path="process-based-modeling---probabilistic-and-process-simulation.html"><a href="process-based-modeling---probabilistic-and-process-simulation.html#repo-link-3"><i class="fa fa-check"></i><b>4.1.2</b> Repo link</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="process-based-modeling---probabilistic-and-process-simulation.html"><a href="process-based-modeling---probabilistic-and-process-simulation.html#monte-carlo-simulation"><i class="fa fa-check"></i><b>4.2</b> Monte Carlo Simulation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="process-based-modeling---probabilistic-and-process-simulation.html"><a href="process-based-modeling---probabilistic-and-process-simulation.html#learning-module-5"><i class="fa fa-check"></i><b>4.2.1</b> Learning Module 5</a></li>
<li class="chapter" data-level="4.2.2" data-path="process-based-modeling---probabilistic-and-process-simulation.html"><a href="process-based-modeling---probabilistic-and-process-simulation.html#repo-link-4"><i class="fa fa-check"></i><b>4.2.2</b> Repo link</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-classification-and-application.html"><a href="model-classification-and-application.html"><i class="fa fa-check"></i><b>5</b> Model Classification and Application</a>
<ul>
<li class="chapter" data-level="5.1" data-path="model-classification-and-application.html"><a href="model-classification-and-application.html#classifying-model-structure"><i class="fa fa-check"></i><b>5.1</b> Classifying model structure</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="model-classification-and-application.html"><a href="model-classification-and-application.html#learning-module-6"><i class="fa fa-check"></i><b>5.1.1</b> Learning Module 6</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="model-classification-and-application.html"><a href="model-classification-and-application.html#term-project-assignment-1---10-pnts"><i class="fa fa-check"></i><b>5.2</b> Term Project Assignment 1 - 10 pnts</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="model-classification-and-application.html"><a href="model-classification-and-application.html#brainstorming"><i class="fa fa-check"></i><b>5.2.1</b> Brainstorming</a></li>
<li class="chapter" data-level="5.2.2" data-path="model-classification-and-application.html"><a href="model-classification-and-application.html#data-exploration-and-selection"><i class="fa fa-check"></i><b>5.2.2</b> Data exploration and selection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="physical-process-models.html"><a href="physical-process-models.html"><i class="fa fa-check"></i><b>6</b> Physical Process Models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="physical-process-models.html"><a href="physical-process-models.html#snowmelt-models"><i class="fa fa-check"></i><b>6.1</b> Snowmelt Models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="physical-process-models.html"><a href="physical-process-models.html#learning-module-7"><i class="fa fa-check"></i><b>6.1.1</b> Learning Module 7</a></li>
<li class="chapter" data-level="6.1.2" data-path="physical-process-models.html"><a href="physical-process-models.html#labwork-20-pnts"><i class="fa fa-check"></i><b>6.1.2</b> Labwork (20 pnts)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="physical-process-models.html"><a href="physical-process-models.html#evapotranspiration"><i class="fa fa-check"></i><b>6.2</b> Evapotranspiration</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="physical-process-models.html"><a href="physical-process-models.html#repo-here"><i class="fa fa-check"></i><b>6.2.1</b> Repo here</a></li>
<li class="chapter" data-level="6.2.2" data-path="physical-process-models.html"><a href="physical-process-models.html#learning-module-8"><i class="fa fa-check"></i><b>6.2.2</b> Learning Module 8</a></li>
<li class="chapter" data-level="6.2.3" data-path="physical-process-models.html"><a href="physical-process-models.html#labwork-20-pts-1"><i class="fa fa-check"></i><b>6.2.3</b> Labwork (20 pts):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html"><i class="fa fa-check"></i><b>7</b> Spatial Models and GIS Integration</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#gridded-and-tabular-data-retrieval"><i class="fa fa-check"></i><b>7.1</b> Gridded and tabular data retrieval</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#learning-module-9"><i class="fa fa-check"></i><b>7.1.1</b> Learning Module 9</a></li>
<li class="chapter" data-level="7.1.2" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#repo-link-5"><i class="fa fa-check"></i><b>7.1.2</b> Repo link</a></li>
<li class="chapter" data-level="7.1.3" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#labwork-20-pnts-1"><i class="fa fa-check"></i><b>7.1.3</b> Labwork (20 pnts)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#dem-processing"><i class="fa fa-check"></i><b>7.2</b> DEM processing</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#learning-module-10"><i class="fa fa-check"></i><b>7.2.1</b> Learning Module 10</a></li>
<li class="chapter" data-level="7.2.2" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#the-link-to-the-repo-is-here"><i class="fa fa-check"></i><b>7.2.2</b> THE LINK TO THE REPO IS HERE</a></li>
<li class="chapter" data-level="7.2.3" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#labwork-20-pts-2"><i class="fa fa-check"></i><b>7.2.3</b> Labwork (20 pts)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#hbv-hydrology-model"><i class="fa fa-check"></i><b>7.3</b> HBV Hydrology Model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#learning-module-9-1"><i class="fa fa-check"></i><b>7.3.1</b> Learning Module 9</a></li>
<li class="chapter" data-level="7.3.2" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#repo-link-6"><i class="fa fa-check"></i><b>7.3.2</b> Repo link</a></li>
<li class="chapter" data-level="7.3.3" data-path="spatial-models-and-gis-integration.html"><a href="spatial-models-and-gis-integration.html#labwork-20-pnts-2"><i class="fa fa-check"></i><b>7.3.3</b> Labwork (20 pnts)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Environmental Methods: LRES 546</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="process-based-modeling---probabilistic-and-process-simulation" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Process-Based Modeling - Probabilistic and Process Simulation<a href="process-based-modeling---probabilistic-and-process-simulation.html#process-based-modeling---probabilistic-and-process-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>* Modules 4.1 and 4.2 are adapted from Fabian Nipggen (REWM.4500.500)<br />
</p>
<div id="transfer-function-rainfall-runoff-models" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Transfer function rainfall-runoff models<a href="process-based-modeling---probabilistic-and-process-simulation.html#transfer-function-rainfall-runoff-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="learning-module-4" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Learning Module 4<a href="process-based-modeling---probabilistic-and-process-simulation.html#learning-module-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="summary-1" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Summary<a href="process-based-modeling---probabilistic-and-process-simulation.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In previous modules, we focused on <em>where</em> water goes in a watershed and whether it runs off quickly as stormflow or moves slowly through storage and contributes to baseflow. In this module, we shift focus to <em>when</em> water arrives at the stream.</p>
<p>Why does timing matter?</p>
<ul>
<li><p>Water that moves quickly tends to look chemically different than water that moves slowly</p></li>
<li><p>Longer travel times allow for more uptake by vegetation or interaction with soils, minerals, and microbes</p></li>
<li><p>The timing of runoff shapes the hydrograph and affects solute transport</p></li>
</ul>
<p>In this module, we will model the temporal aspects of runoff response to input using a transfer function. A transfer function is a tool that describes how rainfall input is translated into runoff output over time.</p>
<div id="overall-learning-objectives-1" class="section level5 hasAnchor" number="4.1.1.1.1">
<h5><span class="header-section-number">4.1.1.1.1</span> Overall Learning Objectives<a href="process-based-modeling---probabilistic-and-process-simulation.html#overall-learning-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>By the end of this module, you should be able to:</p>
<ul>
<li><p>Explain what a transfer function is in plain language</p></li>
<li><p>Describe how water transit time influences runoff timing and composition</p></li>
<li><p>Recognize different ways transit time can be represented in hydrological models</p></li>
<li><p>Interpret (not derive) the basic equations used in transfer-function rainfall–runoff models</p></li>
</ul>
</div>
<div id="key-terms" class="section level5 hasAnchor" number="4.1.1.1.2">
<h5><span class="header-section-number">4.1.1.1.2</span> Key Terms<a href="process-based-modeling---probabilistic-and-process-simulation.html#key-terms" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In modeling a flow system, note that consideration of time may vary depending on the questions being asked. <strong>Transit time</strong> is the average time required for water to travel through the entire flow system, from input (e.g., rainfall on soil surface) to output (e.g., discharge). <strong>Residence time</strong> is a portion of transit time, describing the amount of time water spends within a specific component of the flow system, like storage (e.g., in soil, groundwater, a puddle or a lake).</p>
<p>First, familiarize yourself with the transfer function we will code (TRANSEP) by reading this paper. If the terminology feels dense, you may use AI tools to help extract the key concepts and focus on the big-picture ideas: <br/>
<a href="docs/Weiler_etal_WRR2003.pdf">TRANSEP - a combined tracer and runoff transfer function hydrograph separation model</a>
<br/></p>
<p>Then this text will step through key concepts in the paper to facilitate hands-on exploration of the rainfall-runoff portion of the TRANSEP model in the assessment.</p>
<div class="float">
<img src="https://ars.els-cdn.com/content/image/1-s2.0-S0022169406002150-gr1.jpg" alt="Figure 6.3. Conceptual diagram of the lumped parameter transit time modeling approach (McGuire &amp; McDonnell, 2006)" />
<div class="figcaption">Figure 6.3. Conceptual diagram of the lumped parameter transit time modeling approach (McGuire &amp; McDonnell, 2006)</div>
</div>
<p><br/><br/></p>
<p>A <strong>transfer function</strong> (TF) is a mathematical representation of how a system responds to input signals. In a hydrological context, it describes the transformation of inputs (e.g. precipitation) to outputs (e.g. runoff). In other words, it is a mathematical way of answering the question:
If water enters the watershed at time t, how much of it shows up at the stream later and when?</p>
</div>
<div id="the-linear-time-invariant-tf" class="section level5 hasAnchor" number="4.1.1.1.3">
<h5><span class="header-section-number">4.1.1.1.3</span> The Linear Time-Invariant TF<a href="process-based-modeling---probabilistic-and-process-simulation.html#the-linear-time-invariant-tf" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We start with a linear, time-invariant (LTI) system. The name sounds extravagant, but the assumptions are simple:</p>
<ol style="list-style-type: decimal">
<li><p>Linear: Double the rainfall → double the runoff response</p></li>
<li><p>Time-invariant: The watershed responds the same way today as it did yesterday</p></li>
<li><p>Additive: Responses from multiple rainfall pulses add together</p></li>
</ol>
<p>Under these assumptions, we can represent the watershed as a <strong>linear reservoir</strong>. Linear reservoirs are simple models designed to simulate the storage and discharge of water in a catchment. These models assume that the catchment can be represented as single storage compartments and that</p>
<ol style="list-style-type: decimal">
<li>Water is stored temporarily</li>
<li>the rate of outflow is porportional to how much water is stored</li>
<li>there is no threshold behavior or <a href="https://lewis-thehydrologist.medium.com/understanding-river-hysteresis-3a6bb454add4">hysteresis. external link</a></li>
</ol>
<p>Recall this isn’t how all watersheds work, these are useful approximations.</p>
<p><img src="images/linear_storage_04.png" /></p>
<p><br/><br/></p>
</div>
<div id="the-instantaneous-unit-hydrograph" class="section level5 hasAnchor" number="4.1.1.1.4">
<h5><span class="header-section-number">4.1.1.1.4</span> The Instantaneous Unit Hydrograph:<a href="process-based-modeling---probabilistic-and-process-simulation.html#the-instantaneous-unit-hydrograph" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The Instantaneous Unit Hydrograph (IUH) is the transfer function used in the TRANSEP model. It is an approach to hydrograph separation that is useful for analyzing the temporal distribution of runoff in response to a ‘unit’ pulse of rainfall (e.g. uniform one-mm depth over a unit area represented by a unit hydrograph). In other words, it answers the question: If one unit of effective rainfall fell instantly over the watershed, how would that water be released to the stream over time?
Therefore, the following assumptions are made when the IUH is used as a transfer function: <br/></p>
<ol style="list-style-type: decimal">
<li>the watershed response reflects the ensemble of watershed characteristics <br/></li>
<li>the response shape does not change through time <br/></li>
<li>the output response is linearly proportional to the input (i.e. runoff of scales linearly with rainfall) <br/></li>
</ol>
<p>The IUH is not a specific storm, rather it is a response kernel that we reuse for all storms.</p>
<p><br/><br/></p>
<p><img src="images/linear_vs_IUH.png" alt="Chow, V.T., Maidment, D.R. and Mays, L.W. (1988) Applied Hydrology. International Edition, McGraw-Hill Book Company, New York." />
<br/><br/></p>
</div>
</div>
<div id="from-concept-to-math" class="section level4 hasAnchor" number="4.1.1.2">
<h4><span class="header-section-number">4.1.1.2</span> From Concept to Math<a href="process-based-modeling---probabilistic-and-process-simulation.html#from-concept-to-math" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Don’t worry about deriving or memorizing the following equations; they are included only to help you understand the relationships among variables and reinforce the underlying concepts.</p>
<div id="iuh" class="section level5 hasAnchor" number="4.1.1.2.1">
<h5><span class="header-section-number">4.1.1.2.1</span> IUH<a href="process-based-modeling---probabilistic-and-process-simulation.html#iuh" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In TRANSEP, the IUH is written as a function <span class="math inline">\(g(\tau)\)</span>. This function describes how runoff is distributed through time after rainfall occurs.</p>
<p><span class="math display">\[
g(\tau) = \frac{\tau^{\alpha-1}}{\mathrm{B}^{\alpha}\Gamma(\alpha)}exp(-\frac{\tau}{\alpha})
\]</span>
<br/><br/>
What matters here is that:</p>
<ul>
<li><p>The shape of <span class="math inline">\(g(\tau)\)</span> controls how fast or slow water moves</p></li>
<li><p>Parameters change whether runoff is flashy or delayed</p></li>
<li><p>The function integrates to 1 (mass is conserved)</p></li>
</ul>
</div>
<div id="convolution-turning-rainfall-into-runoff" class="section level5 hasAnchor" number="4.1.1.2.2">
<h5><span class="header-section-number">4.1.1.2.2</span> Convolution: Turning Rainfall into Runoff<a href="process-based-modeling---probabilistic-and-process-simulation.html#convolution-turning-rainfall-into-runoff" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Runoff is calculated by combining rainfall with the transfer function:</p>
<p><span class="math display">\[
Q(t)= \int_{0}^{t} g(\tau)p_{\text{eff}}(t-\tau)d\tau
\]</span>
<br/><br/></p>
<p>Runoff at time t is the sum of past rainfall inputs, each delayed and weighted by the transfer function.</p>
<p>OK, I realize your eyes probably glazed over somewhere around ‘convolution’… don’t worry about the details of the equations. Check out this video to have convolution described using dollars and cookies, then imagine each dollar as a rainfall unit and each cookie as a runoff unit. Review the equations again after the video.</p>
<p><br/><br/></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="process-based-modeling---probabilistic-and-process-simulation.html#cb1-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_url</span>(<span class="st">&quot;https://www.youtube.com/embed/aEGboJxmq-w&quot;</span>)</span></code></pre></div>
<iframe src="https://www.youtube.com/embed/aEGboJxmq-w" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="the-loss-function" class="section level5 hasAnchor" number="4.1.1.2.3">
<h5><span class="header-section-number">4.1.1.2.3</span> The Loss Function:<a href="process-based-modeling---probabilistic-and-process-simulation.html#the-loss-function" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Not all rainfall contributes to runoff. Some is lost to infiltration, evaporation, or temporary storage.</p>
<p>The loss function represents the linear rainfall-runoff model used in the TRANSEP model. In other words, it converts total preciptiation <span class="math inline">\(p(t)\)</span> into effective precipitation <span class="math inline">\(p_{\text{eff}}(t)\)</span>.</p>
<p><span class="math display">\[
s(t) = b_{1} p(t + 1 - b_{2}^{-1}) s(t - \triangle t)
\]</span>
<span class="math display">\[
s(t = 0) = b_{3}
\]</span>
<span class="math display">\[
p_{\text{eff}}(t) = p(t) s(t)
\]</span>
where <span class="math inline">\(p_{\text{eff}}(t)\)</span> is the effective precipitation.<br/>
<span class="math inline">\(s(t)\)</span> is the antecedent precipitation index which is determined by giving more importance to recent precipitation and gradually reducing that importance as we go back in time (i.e. recent rainfall matters more than old rainfall). <br/>
The rate at which this importance decreases is controlled by the parameter <span class="math inline">\(b_{2}\)</span>. <br/>
The parameter <span class="math inline">\(b_{3}\)</span> sets the initial antecedent precipitation index at the beginning of the simulated time series.</p>
<p>Again: the goal is behavior, not physical realism.</p>
<p>Transfer-function models are powerful because they:</p>
<ul>
<li><p>Explicitly represent timing, not just volume</p></li>
<li><p>Allow separation of rainfall input and watershed response</p></li>
<li><p>Provide a bridge between hydrology and tracer studies</p></li>
</ul>
<p>They are also limited:</p>
<ul>
<li><p>They assume linearity</p></li>
<li><p>They hide spatial heterogeneity</p></li>
<li><p>They trade physical detail for interpretability</p></li>
</ul>
<p>Understanding these tradeoffs is more important than memorizing equations.</p>
</div>
<div id="how-do-we-code-this" class="section level5 hasAnchor" number="4.1.1.2.4">
<h5><span class="header-section-number">4.1.1.2.4</span> How do we code this?<a href="process-based-modeling---probabilistic-and-process-simulation.html#how-do-we-code-this" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We will use a skeletal version of TRANSEP, focusing only on the rainfall-runoff piece which includes the loss-function and the gamma transfer function.</p>
<p>We will use rainfall and runoff data from the Tenderfoot Creek Experimental Forest to model annual streamflow at a daily time step. Then we can use this model as a jump-off point to start talking about model calibration and validation in future modules.</p>
</div>
<div id="final-thoughts" class="section level5 hasAnchor" number="4.1.1.2.5">
<h5><span class="header-section-number">4.1.1.2.5</span> Final thoughts:<a href="process-based-modeling---probabilistic-and-process-simulation.html#final-thoughts" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If during your modeling experience, you find yourself wading through a bog of complex physics and multiple layers of transfer functions to account for every drop of input into a system, it is time to revisit your objectives. Remember that a model is always ‘wrong’, but it can help us understand complex systems, make predictions, and gain insights even if they are not an exact replica of the real world. Check out this paper for more:</p>
<p><a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/93WR00877" class="uri">https://agupubs.onlinelibrary.wiley.com/doi/10.1029/93WR00877</a></p>
</div>
</div>
</div>
<div id="repo-link-3" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Repo link<a href="process-based-modeling---probabilistic-and-process-simulation.html#repo-link-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://github.com/tpcovino/04_transfer_functions.git" target="_blank">Download the repo for this lab HERE</a></p>

</div>
</div>
<div id="monte-carlo-simulation" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Monte Carlo Simulation<a href="process-based-modeling---probabilistic-and-process-simulation.html#monte-carlo-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="learning-module-5" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Learning Module 5<a href="process-based-modeling---probabilistic-and-process-simulation.html#learning-module-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="background" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Background:<a href="process-based-modeling---probabilistic-and-process-simulation.html#background" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Monte Carlo Simulation is a method to estimate the probability of the outcomes of an uncertain event. It is based on a law of probability theory that says if we repeat an experiment many times, the average of the results will get closer to the true probability of those outcomes.</p>
<p>First check out this video:
<iframe src="https://www.youtube.com/embed/7TqhmX92P6U" width="672" height="400px" data-external="1"></iframe></p>
</div>
<div id="reading" class="section level4 hasAnchor" number="4.2.1.2">
<h4><span class="header-section-number">4.2.1.2</span> Reading<a href="process-based-modeling---probabilistic-and-process-simulation.html#reading" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Then read this: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2924739/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2924739/</a> for a understanding of the fundamentals.</p>
</div>
<div id="how-does-this-apply-to-hydrological-modeling" class="section level4 hasAnchor" number="4.2.1.3">
<h4><span class="header-section-number">4.2.1.3</span> How does this apply to hydrological modeling?<a href="process-based-modeling---probabilistic-and-process-simulation.html#how-does-this-apply-to-hydrological-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When modeling watershed hydrological processes, we often attempting to quantify<br><br></p>
<ul>
<li>watershed inputs <br>
<ul>
<li>e.g., precipitation <br></li>
</ul></li>
<li>watershed outputs <br>
<ul>
<li>e.g., <a href="https://www.usgs.gov/special-topics/water-science-school/science/evapotranspiration-and-water-cycle#:~:text=Evapotranspiration%20includes%20water%20evaporation%20into,to%20the%20atmosphere%20via%20plants">evapotranspiration</a>, <a href="https://www.usgs.gov/media/images/sublimation-occurs-snow-covered-mountains">sublimation</a>, runoff/discharge <br></li>
</ul></li>
<li>watershed storage <br>
<ul>
<li>precipitation that is not immediately converted to runoff or ET rather stored as snow or subsurface water. <br></li>
</ul></li>
</ul>
<p>Imagine we are trying to predict the percentage of precipitation stored in a watershed after a storm event. We have learned that there are may factors that affect this prediction, like antecedent conditions, that may be difficult to measure directly. Monte Carlo Simulation can offer a valuable approach to estimate the probability of obtaining certain measurements when those factors can not be directly observed or measured. We can approximate the likelihood of specific measurement by simulating a range of possible scenarios. <br></p>
<p>Monte Carlo Simulation is not only useful for estimating probabilities, but for conducting sensitivity analysis. In any model, there are usually several input parameters. Sensitivity analysis helps us understand how changes in these parameters affect the predicted values. To perform a sensitivity analysis using a Monte Carlo Simulation we can:</p>
<ul>
<li>Define the realistic ranges for each parameter we want to analyze</li>
<li>Using Monte Carlo Simulation, randomly sample values from the defined ranges for each parameter</li>
<li>Analyze output to understand how different input sample values affect the predicted output</li>
</ul>
</div>
<div id="example" class="section level4 hasAnchor" number="4.2.1.4">
<h4><span class="header-section-number">4.2.1.4</span> Example<a href="process-based-modeling---probabilistic-and-process-simulation.html#example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s consider all of this in an example model called <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2014WR016719">WECOH - Watershed ECOHydrology</a>. In this study, researchers (Nippgen et al.) were interested in the change in subsurface water storage through time and space on a daily and seasonal basis.</p>
<div class="float">
<img src="images/wrcr21497-fig-0009-m.jpg" style="width:50.0%" alt="Evolution of watershed connectivity" />
<div class="figcaption">Evolution of watershed connectivity</div>
</div>
<p><br/><br/>
The authors directly measured runoff/discharge, collected precipitation data at several points within the watershed, used remote sensing to estimate how much water was lost to evapotranspiration, and used digital elevation models to characterize the watershed topography. As we learned in the hydrograph separation module, topographic characteristics can have a significant impact on storage. <br>
Though resources like <a href="https://websoilsurvey.sc.egov.usda.gov/app/">USDA’s Web Soil Survey</a> can provide a basic understanding underlying geology across a large region, characterizing the heterogeneous nature of soils within a watershed can be logistically unfeasible. To estimate the soil characteristics like storage capacity (how much water the soil can hold) and hydraulic conductivity (how easily water can move through soil) in the study watershed, the authors used available resources to determine the possible range of values for each of their unknown parameters. They then tested thousands of model simulations using randomly selected values with the predetermined range for each of the soil characteristics. They compared the simulated discharge from these simulations to the actual discharge measurements. The simulations that predicted discharge patterns that closely matched reality helped them to estimate the unknown soil properties. Additionally, from the results of these simulations, they could identify which model inputs had the most significant impact on the discharge predictions, and how sensitive the output was to changes in each parameter. In this case, they determined that the model and system were most sensitive to precipitation. This type of sensitivity analysis can help us interpret the relative importance of different parameters and understand the overall sensitivity of the model or system. The study is linked for your reference but a thorough reading is not required.</p>
</div>
<div id="optional-reading" class="section level4 hasAnchor" number="4.2.1.5">
<h4><span class="header-section-number">4.2.1.5</span> Optional Reading<a href="process-based-modeling---probabilistic-and-process-simulation.html#optional-reading" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="https://www.researchgate.net/publication/262765548_Development_of_probability_distributions_for_urban_hydrologic_model_parameters_and_a_Monte_Carlo_analysis_of_model_sensitivity">This methods paper</a> by Knighton et al. is an example of how Monte Carlo Simulation was used to estimate hydraulic conductivity in an urban system with varied land-cover..</p>
</div>
<div id="generate-a-simulation-with-code" class="section level4 hasAnchor" number="4.2.1.6">
<h4><span class="header-section-number">4.2.1.6</span> Generate a simulation with code<a href="process-based-modeling---probabilistic-and-process-simulation.html#generate-a-simulation-with-code" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For a 12-minute example in RStudio, check this out. If you are still learning the basics of R functionality, it may be helpful to code along with this video, pausing as needed. Note that this instruction is coding in an Rscript (after opening RStudio &gt; File &gt; New File &gt; R Script), rather than an Rmarkdown that we use in this class.</p>
<iframe src="https://www.youtube.com/embed/inJsu-ygBfM" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="repo-link-4" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Repo link<a href="process-based-modeling---probabilistic-and-process-simulation.html#repo-link-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://github.com/tpcovino/05_monte_carlo.git" target="_blank">Download the repo for this lab HERE</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fundamentals-of-hydrological-analysis---physical-hydrology-and-empirical-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-classification-and-application.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/tpcovino/lres_546_bookdown/edit/main/06_transfer_function_lecture_and_lab.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/tpcovino/lres_546_bookdown/blob/main/06_transfer_function_lecture_and_lab.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
